@using Corno.Concept.Portal.Models
@using Corno.Globals.Constants
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Corno - @ViewBag.Title</title>
    <link rel="icon" href="~/favicon.png">

    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")

    <!--This bundle was moved by the Telerik VS Extensions for compatibility reasons-->
    @*	<link href="@Url.Content("~/Content/bootstrap.min.css")" rel="stylesheet" type="text/css" />
    *@
    <link href="@Url.Content("~/Content/DataTables/media/css/jquery.dataTables.min.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/kendo/2023.1.117/kendo.default-v2.min.css")" rel="stylesheet" type="text/css" />


    <script src="@Url.Content("~/Scripts/jquery-3.7.1.min.js")"></script>
    <script src="@Url.Content("~/Scripts/kendo/2023.1.117/jquery.min.js")"></script>

    <script src="@Url.Content("~/Scripts/kendo/2023.1.117/jszip.min.js")"></script>
    <script src="@Url.Content("~/Scripts/kendo/2023.1.117/kendo.all.min.js")"></script>
    <script src="@Url.Content("~/Scripts/kendo/2023.1.117/kendo.aspnetmvc.min.js")"></script>
    <script src="@Url.Content("~/Scripts/kendo/2023.1.117/kendo.aspnetmvc.min.js")"></script>
    <script src="@Url.Content("~/Scripts/DataTables/media/js/jquery.dataTables.min.js")"></script>
    <script src="@Url.Content("~/Scripts/bootbox.min.js")"></script>
    <script src="@Url.Content("~/Scripts/eneter-messaging-7.0.0.js")"></script>
    <script src="@Url.Content("~/Scripts/corno.js")"></script>

    @*<link href="@Url.Content("~/Content/kendo/ReportViewer/styles/telerikReportViewer-17.0.23.118.css")" rel="stylesheet" type="text/css" />
        <script src="@Url.Content("~/Content/kendo/ReportViewer/js/telerikReportViewer-17.0.23.118.min.js")"></script>*@

    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.4.3.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>

    <script src="~/Scripts/pace.min.js"
            data-pace-options='{ "ajax": true, "document": true, "restartOnPushState": true, "restartOnRequestAfter": true }'>
    </script>
    <link href="~/Content/pace/themes/pace-theme-corner-indicator.css" rel="stylesheet" />
    <script src="@Url.Content("~/Scripts/kendo.modernizr.custom.js")"></script>
</head>
<body class="p-0">
<div class="container-fluid">
    <!-- Header -->
    <div class="row">
        <div class="col-12 p-0">
            <!-- Top Bar -->
            <nav class="navbar navbar-expand-sm navbar-dark bg-secondary">
                @*<a class="navbar-brand" href="#">Navbar</a>*@
                @*<button id="sidebarCollapse" type="button" class="btn btn-light btn-sm bg-white shadow-sm">
                            <i class="k-icon k-i-menu"></i>
                        </button>*@
                <button class="btn btn-light btn-sm bg-white shadow-sm" type="button" data-bs-toggle="offcanvas" data-bs-target="#Collapse" aria-controls="Collapse">
                    <i class="k-icon k-i-menu"></i>
                </button>

                <div class="collapse navbar-collapse" id="myNavbar">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item active">
                            @(Html.Kendo().Menu()
                                .Name("mnu")

                                .HtmlAttributes(new { @class = "w-100 text-primary" })
                                .Events(e => e.Select("menuSelect"))
                                .BindTo(FieldConstants.Project, (item, value) =>
                                {
                                    //if (value.ChildNodes.Count > 0)
                                    //{
                                    //    item.ControllerName = string.Empty;
                                    //    item.ActionName = string.Empty;
                                    //}
                                    //if(value.ChildNodes.Count > 0)
                                    //    item.LinkHtmlAttributes.Add("class", "text-white");
                                    item.LinkHtmlAttributes.Add("class", "text-white bg-secondary");
                                    if (item.RouteValues["web"]?.ToString() != "true")
                                        item.Visible = false;
                                    //int i = 0;
                                    //if (value.Attributes[FieldConstants.MiscType] != null)
                                    //{
                                    //    item.RouteValues.Add(FieldConstants.MiscType, value.Attributes[FieldConstants.MiscType]?.ToString());
                                    //}
                                })
                                .SecurityTrimming(false))

                            <script type="text/javascript">
                                    //Put this inside a script block
                                    function menuSelect(e) {
                                        //check to see if href is null or an empty string
                                        //alert(JSON.stringify(e.item));
                                        //alert($(e.item).children(".k-link").text());
                                        //alert($(e.item).find(".k-group").length);
                                        if ($(e.item).find(".k-group").length > 0) {
                                            e.preventDefault();
                                            return false;
                                        }
                                        else {
                                            // You don't really need the 'else' unless you want to do something else with it.
                                            // The default click handler will fire in this case.
                                        }
                                    }
                                </script>
                        </li>
                    </ul>

                </div>
                <div class="bg-secondary text-white text-end d-flex align-items-center">
                    <i class="k-icon k-i-user"> </i>
                    <span> &nbsp;&nbsp; @SessionGlobals.MySession.UserName &nbsp;</span>
                </div>
            </nav>
        </div>
        @*<div class="col-2 bg-secondary text-white text-end d-flex align-items-center">
                    <i class="k-icon k-i-user"> </i>
                    <span> &nbsp;&nbsp; @SessionGlobals.MySession.UserName</span>
                </div>*@
        @*<div class="col-2 bg-secondary text-white text-end d-flex align-items-center">
                    <i class="k-icon k-i-user"> </i>
                    <span> &nbsp;&nbsp; @SessionGlobals.MySession.UserName</span>
                </div>*@

    </div>
    <!-- Content -->
    <div class="row">
        <!-- Left Panel -->
        <div class="offcanvas offcanvas-start" tabindex="-1" id="Collapse" aria-labelledby="Collapse" style="width: auto">
            <div class="offcanvas-body">
                <div class="vertical-nav bg-white" id="MobileSidebar">
                    <div class="py-4 px-3 bg-light">
                        <div class="d-flex align-items-center">
                            <i id="userImage" class="k-icon k-i-user k-mr-3" @*class="fa fa-user-circle fa-3x text-danger mr-3"*@></i>
                            <div class="">
                                <h4 class="m-0">
                                    @SessionGlobals.MySession.UserName
                                </h4>
                                <p class="text-muted mb-0">@Session[FieldConstants.UserType]</p>
                            </div>
                        </div>
                        @(Html.Kendo().TreeView()
                            .Name("mnuTree")
                            .ExpandAll(true)
                            .AutoScroll(true)
                            .HtmlAttributes(new { @class = "overflow: auto;" })
                            .BindTo(FieldConstants.Project, (item, value) =>
                            {
                                if (value.ChildNodes.Count > 0)
                                    item.Enabled = false;

                                if (item.RouteValues["web"]?.ToString() != "true")
                                    item.Visible = false;
                                //var message =
                                //    $@"Title1 : {item?.Text}, Controller1 : {item?.ControllerName ?? string.Empty}, Action1 : {item?.ActionName}, Area1 : ";
                                //message += item?.RouteValues["area"];
                                //Javascript.ConsoleLog(message);
                                //if (value.Attributes[FieldConstants.MiscType] != null)
                                //{
                                //    item.RouteValues.Add(FieldConstants.MiscType, value.Attributes[FieldConstants.MiscType]?.ToString());
                                //}
                            })
                            .SecurityTrimming(false))
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Body -->
        @RenderBody()
    </div>
    <div class="row">
        <!-- Footer -->
        <footer class="card-footer">
            <div class="container pb-0" style="text-align: center">
                <p>Copyright &copy; @DateTime.Now.Year <a href="http://www.concsystems.in" target="_blank">Concept Systems</a>. All Rights Reserved.</p>
            </div>
        </footer>
    </div>
</div>

@*@Scripts.Render("~/bundles/jquery")*@
@Scripts.Render("~/bundles/bootstrap")
@RenderSection("scripts", required: false)
</body>
</html>

<script>
    $(document).ready(function () {
        // Click button on load
        $('#sidebarCollapse').click();
        //$("#sidebarCollapse").trigger("click");
    });

    $(function () {
        // Sidebar toggle behavior
        $('#sidebarCollapse').on('click',
            function () {
                //alert('clicked');
                $('#sidebar, #content').toggleClass('active');
            });
    });
    function myFunction() {
        var x = document.getElementById("MobileSidebar");
        if (x.style.display === "block") {
            x.style.display = "none";
        } else {
            x.style.display = "block";
        }
    }
</script>


