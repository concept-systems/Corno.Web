@using Kendo.Mvc.UI
@model Corno.Web.Areas.Admin.Dto.UserCrudDto

@{
    Layout = "~/Views/Shared/_Layout.cshtml";

    ViewBag.BoxTitle = "Create New User";

    var action = ViewBag.Action;
}

<div class="row">
    <div class="col-6">
        <div class="form-group required row">
            <div class="col-8">
                @(Html.Kendo().TextBoxFor(m => m.FirstName)
                            .Rounded(Rounded.Medium)
                            .Label(label => label
                                .Content("First Name")
                                .Floating(true))
                            .HtmlAttributes(new
                            {
                                @class = "required w-100",
                                style = "width: 100%;" // Adding explicit width
                            }))
            </div>
        </div>
        <div class="form-group required row">
            <div class="col-8">
                @(Html.Kendo().TextBoxFor(m => m.LastName)
                            .Rounded(Rounded.Medium)
                            .Label(label => label
                                .Content("Last Name")
                                .Floating(true))
                            .HtmlAttributes(new
                            {
                                @class = "required w-100",
                                style = "width: 100%;"
                            }))
            </div>
        </div>
        <div class="form-group required row">
            <div class="col-8">
                @(Html.Kendo().TextBoxFor(m => m.Email)
                            .Rounded(Rounded.Medium)
                            .Label(label => label
                                .Content("Email")
                                .Floating(true))
                            .HtmlAttributes(new
                            {
                                @class = "required w-100",
                                style = "width: 100%;"
                            }))
            </div>
        </div>
        <div class="form-group required row">
            <div class="col-8">
                @(Html.Kendo().TextBoxFor(m => m.PhoneNumber)
                            .Rounded(Rounded.Medium)
                            .Label(label => label
                                .Content("Phone No.")
                                .Floating(true))
                            .HtmlAttributes(new
                            {
                                @class = "required w-100",
                                style = "width: 100%;"
                            }))
            </div>
        </div>
    </div>
    <div class="col-6">
        @if (action != "Edit")
        {
            <div class="form-group required row">
                <div class="col-8">
                    @(Html.Kendo().TextBoxFor(m => m.UserName)
                            .Rounded(Rounded.Medium)
                            .Label(label => label
                                .Content("User Name")
                                .Floating(true))
                            .HtmlAttributes(new
                            {
                                @class = "required w-100",
                                style = "width: 100%;"
                            }))
                </div>
            </div>
            <div class="form-group required row">
                <div class="col-8">
                    @(Html.Kendo().TextBoxFor(m => m.Password)
                            .Rounded(Rounded.Medium)
                            .Label(label => label
                                .Content("Password")
                                .Floating(true))
                            .HtmlAttributes(new
                            {
                                type = "password",
                                @class = "required w-100",
                                style = "width: 100%;"
                            }))
                </div>
            </div>
            <div class="form-group required row">
                <div class="col-8">
                    @(Html.Kendo().TextBoxFor(m => m.ConfirmPassword)
                                .Rounded(Rounded.Medium)
                                .Label(label => label
                                    .Content("Confirm Password")
                                    .Floating(true))
                                .HtmlAttributes(new
                                {
                                    type = "password",
                                    @class = "required w-100",
                                    style = "width: 100%;"
                                }))
                </div>
            </div>
        }
    </div>
</div>

<div class="k-card-separator"></div>
<hr />

<div class="row">
    <div class="col-12">
        @(Html.Kendo().Grid(Model.Roles)
                         .Name("grid")
                         .ToolBar(t =>
                         {
                             /*t.Custom()
                                 .HtmlAttributes(new { style = "float: left; margin-right: 0px;" })
                                 .Text("<strong>Roles</strong>");*/
                             t.Search();
                             t.Excel();
                         })
                         .Columns(columns =>
                         {
                             columns.Bound(p => p.RoleName)
                                 .ClientTemplate("#= RoleName #" + "<input type='hidden' name='Roles[#= index(data)#].RoleName' value='#= RoleName #'   />")
                                 .HeaderHtmlAttributes(new { @class = "k-text-center !k-justify-content-center" })
                                 .Title("Name")
                                 .Width(200);
                             columns.Template(@<text></text>)
                                 .ClientTemplate("<input type='checkbox' #= IsSelected ? checked='checked':'' # class='chkIsSelected' name='Roles[#= index(data)#].IsSelected' value='#= IsSelected #' />")
                                 .HeaderHtmlAttributes(new { @class = "k-text-center !k-justify-content-center" })
                                 .HtmlAttributes(new { @class = "k-text-center !k-justify-content-center text-align-middle" })
                                 .Title("")
                                 .Width(50);
                         })
                         //.Editable(editable => editable.Mode(GridEditMode.InCell))
                         .Scrollable(s => s.Enabled(true).Height("auto").Virtual(true))
                         .Sortable()
                         .Pageable()
                         .PersistSelection()
                         .Height(500)
                         .DataSource(dataSource => dataSource
                             .Ajax()
                             .Model(model =>
                             {
                                 model.Id(p => p.RoleName);
                             })
                             .Aggregates(aggregates =>
                             {
                             })
                             .ServerOperation(false)
                             .Create(update => update.Action("Inline_Create_Update_Destroy", "User"))
                             .Update(update => update.Action("Inline_Create_Update_Destroy", "User"))
                             .Destroy(update => update.Action("Inline_Create_Update_Destroy", "User"))
                         )
                         .Resizable(resize => resize.Columns(true))
                         .Reorderable(reorder => reorder.Columns(true)))

    </div>
</div>



@*@using (Html.BeginForm(action, "User", FormMethod.Post, new { id = "form", enctype = "multipart/form-data" }))
    {
        @Html.ValidationSummary(false)
        @Html.AntiForgeryToken()

        @Html.HiddenFor(m => m.Id)
        <div class="k-card">
            <div class="k-card-header">
                <div class="col-sm-10">
                    <h3>@ViewBag.Title</h3>
                </div>
                <div class="col-sm-2">
                    @(Html.Kendo().Button()
                        .Name("back_to_list")
                        .Content("Back To list")
                        .ApplyStandardSettingsWithType(ButtonType.Info, "arrow-left", ComponentSize.Medium)
                        .Events(e => e.Click("onBackToList"))
                        .HtmlAttributes(new { @class = "w-100" }))
                </div>
            </div>
            <div class="k-card-separator"></div>
            <div class="k-card-body">
                <div class="row">
                    <div class="form-group">
                        <div class="col-sm-6">
                            @(Html.Kendo().TextBoxFor(m => m.FirstName)
                                .Rounded(Rounded.Medium)
                                .Label(label => label
                                    .Content("First Name")
                                    .Floating(true))
                                .HtmlAttributes(new
                                {
                                    @class = "required w-100"
                                }))
                        </div>
                        <div class="col-sm-6">
                            @(Html.Kendo().TextBoxFor(m => m.LastName)
                                .Rounded(Rounded.Medium)
                                    .Label(label => label
                                    .Content("Last Name")
                                    .Floating(true))
                                .HtmlAttributes(new
                                {
                                    @class = "required w-100"
                                }))
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-6">
                            @(Html.Kendo().TextBoxFor(m => m.Email)
                                .Rounded(Rounded.Medium)
                                    .Label(label => label
                                    .Content("Email")
                                    .Floating(true))
                                .HtmlAttributes(new
                                {
                                    @class = "required w-100"
                                }))
                        </div>
                        <div class="col-sm-6">
                            @(Html.Kendo().TextBoxFor(m => m.PhoneNumber)
                                .Rounded(Rounded.Medium)
                                    .Label(label => label
                                    .Content("Phone No.")
                                    .Floating(true))
                                .HtmlAttributes(new
                                {
                                    @class = "required w-100"
                                }))
                        </div>
                    </div>
                </div>

                <div class="k-card-separator"></div>
                <hr />
                <div class="row">
                    @@If (action!= FieldConstants.Edit)
                    {
                    <div class="form-group">
                        <div class="col-sm-12">
                            @(Html.Kendo().TextBoxFor(m => m.UserName)
                                .Enable(action == create)
                                .Rounded(Rounded.Medium)
                                .Label(label => label
                                    .Content("User Name")
                                    .Floating(true))
                                .HtmlAttributes(new
                                {
                                    @class = "required w-100"
                                }))
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-6">
                            @(Html.Kendo().TextBoxFor(m => m.Password)
                                .Rounded(Rounded.Medium)
                                .Label(label => label
                                    .Content("Password")
                                .Floating(true))
                                .HtmlAttributes(new
                                {
                                    type = "password",
                                    @class = "required w-100"
                                }))
                        </div>
                        <div class=" col-sm-6">
                            @(Html.Kendo().TextBoxFor(m => m.ConfirmPassword)
                                .Rounded(Rounded.Medium)
                                .Label(label => label
                                    .Content("Confirm Password")
                                    .Floating(true))
                                .HtmlAttributes(new
                                {
                                    type = "password",
                                    @class = "required w-100"
                                }))
                        </div>
                    </div>
                    }
                </div>

                <div class="row">
                    <div class="col-sm-12">
                        @(Html.Kendo().Grid(Model.Roles)
                                 .Name("grid")
                                 .ToolBar(t =>
                                 {
                                     /*t.Custom()
                                         .HtmlAttributes(new { style = "float: left; margin-right: 0px;" })
                                         .Text("<strong>Roles</strong>");*/
                                     t.Search();
                                     t.Excel();
                                 })
                                 .Columns(columns =>
                                 {
                                     columns.Bound(p => p.RoleName)
                                         .ClientTemplate("#= RoleName #" + "<input type='hidden' name='Roles[#= index(data)#].RoleName' value='#= RoleName #'   />")
                                         .HeaderHtmlAttributes(new { @class = "k-text-center !k-justify-content-center" })
                                         .Title("Name")
                                         .Width(200);
                                     columns.Template(@<text></text>)
                                         .ClientTemplate("<input type='checkbox' #= IsSelected ? checked='checked':'' # class='chkIsSelected' name='Roles[#= index(data)#].IsSelected' value='#= IsSelected #' />")
                                         .HeaderHtmlAttributes(new { @class = "k-text-center !k-justify-content-center" })
                                         .HtmlAttributes(new { @class = "k-text-center !k-justify-content-center text-align-middle" })
                                         .Title("")
                                         .Width(50);
                                 })
                                 //.Editable(editable => editable.Mode(GridEditMode.InCell))
                                 .Scrollable(s => s.Enabled(true).Height("auto").Virtual(true))
                                 .Sortable()
                                 .Pageable()
                                 .PersistSelection()
                                 .Height(500)
                                 .DataSource(dataSource => dataSource
                                     .Ajax()
                                     .Model(model =>
                                     {
                                         model.Id(p => p.RoleName);
                                     })
                                     .Aggregates(aggregates =>
                                     {
                                     })
                                     .ServerOperation(false)
                                     .Create(update => update.Action("Inline_Create_Update_Destroy", "User"))
                                     .Update(update => update.Action("Inline_Create_Update_Destroy", "User"))
                                     .Destroy(update => update.Action("Inline_Create_Update_Destroy", "User"))
                                 )
                                 .Resizable(resize => resize.Columns(true))
                                 .Reorderable(reorder => reorder.Columns(true)))

                    </div>
                </div>
            </div>
            <div class="k-card-footer">
                <div class="col-sm-offset-11 col-sm-1 text-right">
                    @(Html.Kendo().Button()
                            .Name("save")
                            .Content("Save")
                            .ApplyStandardSettingsWithType(ButtonType.Save, "save", ComponentSize.Medium)
                            .HtmlAttributes(new
                            {
                                type = "submit",
                                //name = "action:Create",
                            }))
                </div>
            </div>
        </div>
    }*@

<script>

    $(function () {
        $('#grid').on('click', '.chkIsSelected',
            function () {
                var checked = $(this).is(':checked');
                var grid = $('#grid').data().kendoGrid;
                var dataItem = grid.dataItem($(this).closest('tr'));
                dataItem.set('IsSelected', checked);
            });
    });

    function onBackToList() {
        window.location.href = '/Masters/User/Index';
    }


</script>