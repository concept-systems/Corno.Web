@using Corno.Web.Areas.Admin.Dto
@using Corno.Web.Globals
@using Kendo.Mvc.UI
@model MenuDto

@{
    Layout = "~/Views/Shared/_LayoutEdit.cshtml";
}

@{
    ViewBag.BoxTitle = $"Edit Menu : {Model.DisplayName}";
    ViewBag.Controller = "Menu";
    ViewBag.SubmitAction = "Edit";
    ViewBag.Area = "Admin";

    var viewDataDictionary = new ViewDataDictionary
{
        { FieldConstants.Title, "Edit Menu : " + Model.DisplayName },
        { FieldConstants.Action, "Edit" }
    };
}

@section sectionCrudFooter
{
    <div class="k-actions k-actions-horizontal k-actions-end">
        @Html.Partial("Buttons/_BackButton")
        @Html.Partial("Buttons/_SaveButton")
        @Html.Partial("Buttons/_DeleteButton")
    </div>
}

@Html.ValidationSummary(false)

@Html.Partial("_Menu", Model, viewDataDictionary)

<script>
    function confirmDelete() {
        bootbox.confirm({
            title: 'Confirm Delete',
            message: 'Are you sure you want to delete this menu? This action cannot be undone.',
            buttons: {
                'cancel': {
                    label: 'Cancel',
                    className: 'btn-default pull-left'
                },
                'confirm': {
                    label: 'Delete',
                    className: 'btn-danger pull-right'
                }
            },
            callback: function (result) {
                if (true === result) {
                    $.ajax({
                        url: '@Url.Action("Delete", "Menu", new { area = "Admin" })',
                        type: "POST",
                        data: { id: @Model.Id },
                        headers: {
                            'RequestVerificationToken': $('input[name="__RequestVerificationToken"]').val()
                        },
                        success: function() {
                            window.location.href = '@Url.Action("Index", "Menu", new { area = "Admin" })';
                        },
                        error: function(xhr) {
                            bootbox.alert({
                                title: 'Error',
                                message: xhr.responseJSON?.message || "Failed to delete menu"
                            });
                        }
                    });
                }
            }
        });
    }
</script>

