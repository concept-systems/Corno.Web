@using Corno.Web.Globals
@using Corno.Web.Helper
@using Kendo.Mvc.UI
@model Corno.Web.Areas.DemoProject.Dtos.SalesInvoiceDto

@{
    Layout = "~/Views/Shared/_LayoutBase.cshtml";
}

@{
    ViewBag.Title = "New Sales Invoice";
    ViewBag.BoxTitle = "Create New Sales Invoice";
    ViewBag.SubmitAction = "Create";
}

@{
    ViewBag.MainMenu = "DemoProject";
    ViewBag.MainHeader = "Sales Invoice";
    ViewBag.CurrentSitemap = "Sales Invoice";
    ViewBag.Title = "Sales Invoice";
    ViewBag.Area = "DemoProject";
    ViewBag.Controller = "SalesInvoice";
}

@section sectionBaseHeader
{
    <div class="k-card-actions k-actions-horizontal k-actions-end">
        @Html.Partial("~/Areas/DemoProject/Views/SalesInvoice/_SalesInvoiceHeaderButtons.cshtml")
    </div>
}

@Html.Partial(@"~\Areas\DemoProject\Views\SalesInvoice\_SalesInvoice.cshtml", Model)

<script>
    // Preview and Print functions are defined in _SalesInvoice.cshtml
    // Override onPrintSuccess for Create page to clear form after print
    var originalOnPrintSuccess = onPrintSuccess;
    onPrintSuccess = function () {
        originalOnPrintSuccess();

        // Clear form fields after successful print
        $("#MobileNo").data("kendoMaskedTextBox").value("");
        $("#CustomerName").data("kendoTextBox").value("");
        $("#InvoiceDate").data("kendoDatePicker").value(null);
        $("#PaymentMode").data("kendoComboBox").value("");
        $("#PaidAmount").data("kendoNumericTextBox").value(null);

        // Clear grid
        var grid = $("#grid").data("kendoGrid");
        if (grid) {
            grid.dataSource.data([]);
        }

        // Clear barcode field
        var barcodeTextBox = $('#Barcode').data('kendoTextBox');
        if (barcodeTextBox) {
            barcodeTextBox.value("");
        }
    };
</script>

