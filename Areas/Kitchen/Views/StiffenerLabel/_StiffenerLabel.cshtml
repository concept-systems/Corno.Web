@using Corno.Web.Globals
@using Corno.Web.Helper
@using Kendo.Mvc.UI
@model Corno.Web.Areas.Kitchen.Dto.StiffenerLabel.StiffenerLabelCrudDto
@{
    ViewBag.BoxTitle = "Stiffener Label";
}

<style>
    /* StiffenerLabel specific responsive table styles */
    .stiffenerlabel-table {
        width: 100%;
        table-layout: auto;
    }

    .stiffenerlabel-table td {
        padding: 8px;
        word-wrap: break-word;
    }

    .stiffenerlabel-table td:first-child {
        font-weight: 600;
        white-space: nowrap;
        min-width: 120px;
    }

    /* Responsive buttons */
    .stiffenerlabel-actions {
        flex-wrap: wrap;
        gap: 8px;
    }

    .stiffenerlabel-actions .k-button {
        flex: 1 1 auto;
        min-width: 120px;
    }

    /* Responsive breakpoints */
    @@media (max-width: 992px) {
        .stiffenerlabel-table td:first-child {
            min-width: 100px;
        }
    }

    @@media (max-width: 768px) {
        .stiffenerlabel-table {
            font-size: 0.9em;
        }

        .stiffenerlabel-table td {
            padding: 6px 4px;
            display: block;
            width: 100%;
            border-bottom: 1px solid #e5e5e5;
        }

        .stiffenerlabel-table td:first-child {
            font-weight: 700;
            background: #f8f9fa;
            padding-top: 10px;
            padding-bottom: 4px;
            border-bottom: 2px solid #dee2e6;
        }

        .stiffenerlabel-table td:last-child {
            padding-bottom: 10px;
        }

        .stiffenerlabel-table tr {
            display: block;
            margin-bottom: 10px;
            border: 1px solid #e5e5e5;
            border-radius: 4px;
            padding: 0;
        }

        .stiffenerlabel-table tbody {
            display: block;
        }

        .stiffenerlabel-actions {
            flex-direction: column;
        }

        .stiffenerlabel-actions .k-button {
            width: 100%;
            min-width: unset;
        }
    }

    @@media (max-width: 576px) {
        .stiffenerlabel-table {
            font-size: 0.85em;
        }

        .stiffenerlabel-table td {
            padding: 5px 3px;
        }
    }
</style>

@(Html.Kendo().TileLayout()
    .Name("tileLayout")
    .Columns(2)
    .RowsHeight("140px")
    .ColumnsWidth("100%")
    .Containers(c => {
         c.Add()
             .BodyTemplateId("partial-view")
             .Header(h => h.Text("Header Info"))
             .ColSpan(1)
             .RowSpan(4);
         c.Add()
             .BodyTemplateId("template-items-Info")
             .Header(h => h.Text("Items Info"))
             .ColSpan(1)
             .RowSpan(4);
    })
    .Reorderable(true)
    .Resizable(true))


<script id="partial-view" type="text/x-kendo-template">
    <div class="col-12">
          <!-- Placeholder for the partial view -->
          @*<div id="partialViewContainer" style="height: 100%"></div>*@
    </div>
</script>
<script id="template-items-Info" type="text/x-kendo-template">
  <div class=" k-content">
         <table class="table k-table k-table-alt-row w-100 stiffenerlabel-table">
            <tbody>
                <tr>
                    <td>Due Date :</td>
                    <td>
                        @(Html.Kendo().DatePickerFor(m => m.DueDate)
                            .Format("yyyy-MM-dd")
                            .Events(e => e.Change("onChange"))
                            .HtmlAttributes(new { required = "required", @class = "w-100" }).ToClientTemplate())
                    </td>
                </tr>
                <tr>
                    <td>Lot No :</td>
                    <td>
                        @(Html.Kendo().MultiColumnComboBoxFor(m => m.LotNo)
                            .DataTextField(FieldConstants.LotNo)
                            .DataValueField(FieldConstants.LotNo)
                            .HtmlAttributes(new { required = "required", @class = "w-100" })
                            .Filter(FilterType.Contains)
                            .Placeholder("Select ...")
                            .Suggest(true)
                            .Columns(columns => { columns.Add().Field(FieldConstants.LotNo).Title(FieldConstants.LotNo); })
                            .DataSource(dataSource => dataSource
                                .Read(read => { read.Action("GetLotNos", "StiffenerLabel").Data("getLotParameters"); })
                                .ServerFiltering(true)
                            )
                            .AutoBind(false)
                            .CascadeFrom(FieldConstants.DueDate).ToClientTemplate())
                    </td>
                </tr>
                <tr>
                    <td>Drawing No :</td>
                    <td>
                        @(Html.Kendo().MultiColumnComboBoxFor(m => m.DrawingNo)
                            .DataTextField(FieldConstants.DrawingNo)
                            .DataValueField(FieldConstants.DrawingNo)
                            .HtmlAttributes(new { required = "required", @class = "w-100" })
                            .Filter(FilterType.Contains)
                            .Placeholder("Select ...")
                            .Suggest(true)
                            .Columns(columns => { columns.Add().Field(FieldConstants.DrawingNo).Title(FieldConstants.DrawingNo); })
                            .DataSource(dataSource => dataSource
                                .Read(read => { read.Action("GetDrawingNo", "StiffenerLabel").Data("getDrawingNoParameters"); })
                                .ServerFiltering(true)
                            )
                            .AutoBind(false)
                            .CascadeFrom(FieldConstants.LotNo).ToClientTemplate())
                    </td>
                </tr>
            </tbody>
        </table>
</div>
</script>
<script type="text/javascript">
    $(document).ready(function () {
        // TileLayout responsiveness is now handled by tilelayout-responsive.js
        // No additional code needed here
    });

    function onChange(e) {
        var cmblotNo = $("#LotNo").data("kendoMultiColumnComboBox");
        if (cmblotNo) {
            cmblotNo.value(null);
            cmblotNo.text("");
            cmblotNo.dataSource.read();
        }
    }

    function getLotParameters() {
        return {
            dueDate: $('#DueDate').val()
        };
    }

    function getDrawingNoParameters() {
        return {
            lotNo: $('#LotNo').val()
        };
    }
</script>
